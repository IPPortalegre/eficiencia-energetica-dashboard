<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <title>Eficiência Energética | Campus IPP</title>

  <!-- Estilos e bibliotecas -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
  <script src="https://kit.fontawesome.com/2f941c78c7.js" crossorigin="anonymous"></script>

  

  <style>
    .card h1 {
      font-size: 2rem;
      font-weight: bold;
    }
    .highlight-card {
      border-radius: 12px;
      padding: 10px;
      color: white;
    }
    .green-bg { 
      background-color: #06a04e; 
      width:320px!important;
      height:320px!important;
      margin-left: -8px!important;
   
    }
    .yellow-bg { 
      background-color: #f9de29;
      color: #333; 
      width:320px!important;
      height:320px!important;
      
    }
    .header-title {
      font-size: 1.8rem;
      font-weight: bold;
      margin-left:8px;
    }
    .cardnormal {
      width: auto;
      height: auto;
      margin-top: 10px;
      margin-left: -10px;
    }
    .card-body-fonten {
      padding-left: 20px;
      padding-right: 10px;
      width:100%;
    
    }
    .chart-card {
      border-radius: 12px;
      background-color: #f8f9fa;
      margin-left: 18px;
      margin-right: -24px;
    }
    .card {
      box-shadow: 0 4px 8px rgba(48, 48, 48, 0.1);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      
    }
    .card:hover {
      transform: scale(1.03);
      cursor: pointer;
      transform: translateY(-2px);
      box-shadow: 0 6px 10px rgba(0, 0, 0, 0.2);

    }
 
    .badge-date {
      font-size: 1.48rem;
      font-weight: bold;
      border-radius: 12px;
    }
    .icon-tree {
      font-size: 36px;
      color: #f8f9fa !important;
    }
    .material-icons {
      color: #343a40;
    }
    .badge-light {
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); 
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      background-color:#ffffff;
    }
    .badge-light:hover {
      transform: scale(1.03);
      cursor: pointer;
      transform: translateY(-2px);
      box-shadow: 0 6px 10px rgba(0, 0, 0, 0.2);
    }

    .energy-source {
      display: flex;
      align-items: center;
      margin: 15px 0;
    }

    /* Ajustar a width do card fonte de energia */
    .cardfonte{
     width:320px;
     min-width:120px;
     
    }
    #tempicon{
      color: #ff3300;
    }
    #humicon{
      color: #00bcd4;
    }
    .green-card{
      margin-left: 8px!important;
      
    }
    .yellow-card{
      margin-left: 10px!important;
      margin-right:30px!important;
  
      
    }
    .last-card{
      margin-right: 76px!important;
    
    }
    .graphrow {
      margin-top: 20px;
  
    }
    .cardfonte{
      margin-left:2px;
    }
    .humid{
      color: #00bcd4;
    }
    .tempid{
      color:#ff3300;
    }
    .chart-container{
      height:250px;
      
     
    }
    .chart-container-fonte {
      height: 250px;
   
    }
    .chart-container2{
      height:250px;
      
    }
    .card-body{
      width:100%;
    }
    /* Ajustar a width do card de CO2 */
    .cardco2{
      width:656px;
      margin-left:-86px;
      
    }
    body{
      background-color: #f5fff9;
      padding:0;
      width:100%;
    }
    .spacechart{
      margin-right: 8px;
    }
    .spacechart2{
      margin-left: 8px;
    }
   
    .sub-title {
      font-size: 22.9px;
      color: #1a8623;
      margin-top:10px;
      margin-bottom:20px;
      
    }
    .h4bold {
      font-weight: bold;
      color: #1a8623;
    }
    .h4light {
      font-weight: 400;
      
    }
    .fontes-card{
      margin-left:-4px;
    }
    .container{
      max-width: 1700px;
      max-height:1200px;
      padding:5px;
    }
   
    .card-title{
      font-size: 30px;
      font-weight: 500;
      padding:0 auto;
      margin-top:32px;
      
    }
    /* Ajustar o width do chart de energia */
    .carden{
      width:650px;
    }
    .chart-title{
      font-size:26px;
    } 
    /* Ajusta o padding to card de produção global */
    .value1, .unities1{
      padding-top:10px;
    }
    .value2, .unities2{
      padding-top:10px;
    }
    .icon{
      padding-top:4px;
    }
    .value3{
      margin-top:40px;
    }
    .card-title-equi{
      margin-top: 48px;
    }
   .value4{
    margin-top:58px;
   }
   .unities4{
    padding-top:10px;
   }
   .value5, .unities5{
    padding-top:10px;
   
   }
   /* Media queries */


   /* Dispositivos muito pequenos (telemóveis, 600px para baixo) */
   @media only screen and (max-width: 767.98px) {
      .row.text-center.mb-3,
      .row.graphrow {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .green-card {
        order: 1;
        width: 100% !important;
        margin: 10px 0 !important;
      }

      .fontes-card {
        order: 2;
        width: 100% !important;
        margin: 10px 0 !important;
      }

      .cardfonte {
        width: 100% !important;
        margin: 0 auto !important;
      }

      .cardco2 {
        order: 3;
        width: 100% !important;
        margin: 10px 0 !important;
      }

      .yellow-card {
        order: 4;
        width: 100% !important;
        margin: 10px 0 !important;
      }

      .last-card {
        order: 5;
        width: 100% !important;
        margin: 10px 0 !important;
      }

      .carden {
        order: 6;
        width: 100% !important;
        margin: 10px 0 !important;
      }

      .highlight-card,
      .chart-card {
        width: 100% !important;
        height: auto !important;
      }

      .chart-container,
      .chart-container2,
      .chart-container-fonte {
        height: auto !important;
      }

      .cardnormal {
        margin-left: 0 !important;
      }

      .chart-title {
        text-align: center;
        font-size: 18px;
      }
    }


   /* Dispositivos pequenos (tablets em modo retrato e telemóveis grandes) */
    @media only screen and (min-width: 600px) {
      .green-card, .yellow-card {
        width: 320px;
        margin-left: 18px;
        margin-right: 8px;
      }
      .cardfonte {
        width: 320px;
        margin-left: 2px;
      }
      .cardco2 {
        width: 656px;
        margin-left: -86px;
      }
      .carden{
        width: 652px;
      }
      .chart-container, .chart-container-fonte, .chart-container2 {
        height: 250px;
      }
    }
   /* Dispositivos grandes (portateis e computadores) */
    @media only screen and (max-width: 801px) {
      .green-bg, .yellow-bg {
        max-width: 128px!important;
        max-height:190px!important;
        margin-left: -22px !important;
        
      }
      .cardfonte {
        width: 80px;
        margin-left: 2px;
      }
      .cardco2 {
        width: 106px;
        margin-left: -86px;
      }
      .carden{
        width: 652px;
      }
      
      .container {
        max-width: 800px!important;
        max-height: 550px!important;
        padding:10px!important;
        margin:0 auto;
        border:solid 1px black;
    }
      .card-title{
        font-size:11px!important;
      }
      .card-title-equi {
        font-size: 12px!important;
      }
      .cardfonte{
        max-width: 128px;
        height:294px;
        margin-left:-8px!important;
      }
      .cardco2{
        max-width: 210px;
        margin-left: 20px!important;
      }
      .carden{
        max-width: 298px;
        margin-left:-8px!important;
      }
      .chart-title{
        font-size:12px!important;
      }
      .chart-container, .chart-container-fonte, .chart-container2 {
      height: 220px;
    }
  }

    /*  Dispositivos extra grandes (desktops com um ecrã grande e portateis com ecrã grande) */
    @media only screen and (min-width: 1200px) {
    
    .green-bg, .yellow-bg {
      width: 240px!important;
      height:220px!important;
      margin-left: 18px;
      margin-right: 8px;
    }
    .cardfonte {
      width: 240px;
      height:294px;
      margin-left: 2px;
    }
    .cardco2 {
      width: 510px;
      margin-left: -80px;
    }
    .carden{
      width: 510px;
      margin-left:22px;
    }
    .chart-container, .chart-container-fonte, .chart-container2 {
      height: 220px;
    }
    .container {
      max-width: 1400px;
      max-height: 900px;
      padding:20px!important;
      
      margin:0 auto;
    }
    .card-title {
      font-size: 22px;
      margin-bottom:-16px;
    }
  
    .value1, .value2, .value3, .value4, .unities4, .value5, .unities5 {
      margin-bottom: 10px;
      font-size: 20px!important;
    }
    .value1, .value2{
      margin-top:12px;
    }
    .card-title-equi {
      margin-top: 48px;
      font-size: 22px;
    }
    .value4{
      margin-top:24px;
    }
    .unities4{
      margin-top:-10px;
    }
    .value5{
      margin-top:14px;
      margin-bottom:-1px;
    }
    .icon{
      font-size: 22px!important;
      margin-bottom:4px;
    }
    .unities1{
      margin-top:-10px;
    }
   .unities2{
      margin-top:-11px;
    }
    .chart-title{
      font-size:20px;
    }
    .value3{
      margin-top:32px;
    }
    .header-title {
      margin-left: -1px;
    }
    
   }

    @media only screen and (max-width: 1285px) {
    
    .green-bg, .yellow-bg {
      width: 210px!important;
      height:200px!important;
      margin-left: 18px;
      margin-right: 8px;
      margin-top:-6px;
    }
    .cardfonte {
      width: 210px;
      height:230px;
      margin-left: 2px;
    }
    .cardco2 {
      width: 432px;
      margin-left: -72px;
      height: 230px;
    }
    .carden{
      width: 449.3px;
      margin-left:5px;
      height:230px;
    }
    .chart-container, .chart-container-fonte, .chart-container2 {
      height: 180px;
      width:100%;
    }
    .container {
      max-width: 1200px;
      max-height: 900px!important;
      height:550px;
      padding:20px!important;
      
      margin:0 auto;
    }
    .card-title {
      font-size: 20px;
      margin-top:6px;
    }
  
    .value1, .value2, .value3, .value4, .unities4, .value5, .unities5 {
      margin-bottom: 10px;
      font-size: 22px!important;
    }
    .value1, .value2{
      margin-top:12px;
    }
    .card-title-equi {
      margin-top: 6px;
      font-size: 20px;
    }
    .value3{
      margin-top:24px !important;
    }
    .value4{
      margin-top:24px;
    }
    .unities4{
      margin-top:-10px;
    }
    .value5{
      margin-top:14px;
      margin-bottom:-1px;
    }
    .icon{
      font-size: 20px!important;
      margin-bottom:4px;
    }
    .unities1{
      margin-top:-10px;
    }
   .unities2{
      margin-top:-11px;
    }
    .chart-title{
      font-size:20px;
    }
    .value3{
      margin-top:32px;
    }
    .header-title {
      margin-left: -1px;
      font-size: 24px;
      margin-top:-10px;
    }
    .sub-title{
      font-size: 16px;
      margin-top:-14px;
    }

    
   }

   

   /* Para ecrãs com resolução de 1366px */
   @media only screen and (min-width: 1300px){

     .green-bg, .yellow-bg {
      width: 220px!important;
      height:220px!important;
      margin-left: 18px;
      margin-right: 8px;
    }
    .cardfonte {
      width: 220px;
      height:220px;
      margin-left: 2px;

    }
    .cardco2 {
      width: 458px;
      margin-left: -75px;
     height:220px;
    }
    .carden{
      width: 470px;
      margin-left:10px;
      height:220px;
    }
    .chart-container, .chart-container-fonte, .chart-container2 {
      height: 150px;
   
    }
    .container {
      max-width: 1300px;
      max-height: 628px;
      padding:40px!important;
      margin:0 auto;
      margin-top:-20px!important;
    }
    .card-title {
      font-size: 22px;
      margin-bottom:-14px;
    }
  
    .value1, .value2, .value3, .value4, .unities4, .value5, .unities5 {
      margin-bottom: 10px;
      font-size: 20px!important;
    }
    .value1, .value2{
      margin-top:12px;
    }
    .card-title-equi {
      margin-top: 28px;
      font-size: 22px;
    }
    .value4{
      margin-top:24px;
    }
    .unities4{
      margin-top:-10px;
    }
    .value5{
      margin-top:14px;
      margin-bottom:-1px;
    }
    .icon{
      font-size: 22px!important;
      margin-bottom:4px;
    }
    .unities1{
      margin-top:-10px;
    }
   .unities2{
      margin-top:-11px;
    }
    .chart-title{
      font-size:20px;
    }
    .value3{
      margin-top:32px;
    }
    .header-title {
      margin-left: -1px;
    }
    


   }


  /*  Dispositivos extra grandes (desktops com um ecrã grande e portateis com ecrã grande) */
   @media only screen and (min-width: 1800px) {
    
    .green-bg{
      width: 322px!important;
      height:310px!important;
      margin-left: 18px;
      margin-right: 8px;
    }
    .equi-card{
      margin-left:-2px!important;
    }
    .yellow-bg{
      width: 312px!important;
      height:310px!important;
      margin-left: 18px;
      margin-right: 8px;
    }
    .yellow-last{
      margin-left: 30px!important;
    }
    .cardfonte {
      width: 320px;
      margin-left: 2px;
      height:340px;
    }
    .cardco2 {
      width: 676px;
      height:340px;
      margin-left:-90px!important;
    }
    .carden{
      width: 654px;
      height:340px;
      margin-left:56px;
    }
    .chart-container, .chart-container-fonte, .chart-container2 {
      height: 250px;
      width:100%;
    }
    .container{
      max-width: 1800px!important;
      min-height: 900px!important;
      margin:0 auto;
     
    }
    .card-title {
      font-size: 28px;
      margin-bottom:-12px;
      margin-top:50px;
    }
  
    .value1, .unities1, .value2, .unities2, .value3, .icon, .value4, .unities4, .value5, .unities5 {
      margin-bottom: 10px;
      font-size: 30px!important; 
    }
    .chart-title{
      font-size:24px;
    }
    
    
   }


   

  </style>
</head>
<body>
  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap"> 
      <h2 class="header-title ">EFICIÊNCIA ENERGÉTICA</h2>
      <div class="d-flex align-items-center gap-3">
        <span class="badge badge-light p-2 mr-2" data-toggle="tooltip" data-placement="top" title="Temperatura">
          <i class="material-icons md-18 align-middle" id="tempicon">device_thermostat</i>
          <span class="align-middle ml-1 tempid" id="temperatura"></span>
          <span class="align-middle ml-1" id="tempicon">°C</span>
        </span>
        <span class="badge badge-light p-2 mr-2" data-toggle="tooltip" data-placement="top" title="Humidade">
          <i class="material-icons md-18 align-middle" id="humicon">opacity</i>
          <span class="align-middle ml-1 humid" id="humidade"></span>
          <span class="align-middle ml-1" id="humicon">%</span>
        </span>
        <span class="badge badge-light p-2 badge-date" id="currentDate">-</span>
      </div>
      
    </div>

    <h4 class="sub-title"><span class="h4light">PRODUÇÃO DE ENERGIA RENOVÁVEL</span> | <span class="h4bold">CAMPUS POLITÉCNICO</span></h4>

    <!-- Cards principais -->
    <div class="row justify-content-md-center text-center mb-3">
      <div class="col-md-2 mx-auto green-card">
        <div class="card cardnormal highlight-card green-bg square-card">
          <div class="card-body ">
            <h5 class="card-title">Produção Global Energia</h5>
          
            <h1 class="value1" id="energiasolartotal">-</h1>
            <h5 class="unities1">kWh</h5>
            
          </div>
        </div>
      </div>
      
      <div class="col-md-2 mx-auto green-card">
        <div class="card cardnormal highlight-card green-bg square-card">
          <div class="card-body">
            <h5 class="card-title">CO2 Evitado (acumulado)</h5>
          
            <h1 class="value2" id="co2evitadototal">-</h1>
            <h5 class="unities2">ton</h5>
           
          </div>
        </div>
      </div>
      <div class="col-md-2 mx-auto green-card">
        <div class="card cardnormal highlight-card green-bg equi-card square-card">
          <div class="card-body">
            <h5 class="card-title card-title-equi">CO2 Equivalente</h5>
           
            <h1 class="value3" id="co2equivalente">-</h1><i class="material-icons icon-tree md-18 align-middle icon">forest</i>
            
          </div>
        </div>
      </div>
      
      <div class="col-md-2 mx-auto yellow-card">
        <div class="card cardnormal highlight-card yellow-bg square-card">
          <div class="card-body">
            <h5 class="card-title">Energia Produzida</h5>
            
            <h1 class="value4" id="producaoinstantaneo">-</h1>
            <h5 class="unities4">kWh</h5>
           
          </div>
        </div>
      </div>
      
      <div class="col-md-2 mx-auto yellow-card last-card">
        <div class="card cardnormal highlight-card yellow-bg square-card yellow-last">
          <div class="card-body">
            <h5 class="card-title">Energia Consumida</h5>
            
            <h1 class="value5" id="consumoinstantaneo">-</h1>
            <h5 class="unities5">kWh</h5>
            
          </div>
        </div>
      </div>
      
    </div>

    <!-- Gráficos -->

    <div class="row graphrow">
      <div class="col-md-3 mb-3 fontes-card">
          <div class="card chart-card cardfonte">
            
            <div class="card-body card-body-fonten text-center">
              <h5 class="chart-title">Fontes de Energia</h5>
              <div class="chart-container-fonte">
              
              <canvas id="ensource-chart"></canvas>
             </div>
            </div>
          </div>
      </div>
     

    
      <div class="col-md-4 mb-3">
        <div class="card chart-card cardco2">
      
          <div class="card-body">
            <h5 class="text-center chart-title"><span class="spacechart">Evolução Temporal</span> |   <span class="spacechart2">CO2</span></h5>
            <div class="chart-container2">
              <canvas id="chart-co2"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-5 mb-3">
        <div class="card chart-card carden">
          <div class="card-body">
            <h5 class="text-center chart-title"><span class="spacechart">Evolução Temporal</span> |   <span class="spacechart2">Energia</span></h5>
            <div class="chart-container">
              <canvas id="chart-energia"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--gráficos scripts -->
  <script>

   //gráfico fonte de energia
      function createEnergySourceChart(solarValue, redeValue) {
        const ctx = document.getElementById('ensource-chart').getContext('2d');
        
        const total = solarValue + redeValue;
        const solarPercent = Math.round((solarValue / total) * 100);
        const redePercent = Math.round((redeValue / total) * 100);

        energySourceChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['Fontes de Energia'],
            datasets: [
              {
                label: 'Solar',
                data: [solarPercent],
                backgroundColor: 'rgba(8,158,84,255)',
                borderRadius: 14,
                borderSkipped: false,
                barThickness: 40
              },
              {
                label: 'Rede',
                data: [redePercent],
                backgroundColor: '#eb9e0a',
                borderRadius: 14,
                borderSkipped: false,
                barThickness: 40
              }
            ]
          },
          options: {
            indexAxis: 'y',
            responsive: true,
            maintainAspectRatio: false,
            onResize: function(chart) {
              // This will force a redraw when the chart resizes
              chart.update();
            },
            plugins: {
              legend: {
                display: true,
                position: 'bottom',
                align: 'center',
                maxHeight: 40,
                padding: 10,
                labels: {
                  font: {
                    size: 16
                  },
                  usePointStyle: true,
                  pointStyle: 'rectRounded'
                }
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    const value = context.raw;
                    return `${context.dataset.label}: ${value}%`;
                  }
                }
              }
            },
            scales: {
              x: {
                min: 0,
                max: 100,
                title: { display: false },             
                grid: { display: false }
              },
              y: {
                display: false,
                grid: { display: false }
              }
            }
          }
        });
      }
      let energySourceChart;

      function updateEnergySourceChart(solarValue, redeValue) {
        if (!energySourceChart) {
          createEnergySourceChart();
        }

        // calcula porcentagens
        const total = solarValue + redeValue;
        const solarPercent = Math.round((solarValue / total) * 100);
        const redePercent = Math.round((redeValue / total) * 100);

        // atualiza os dados do gráfico
        energySourceChart.data.datasets[0].data = [solarPercent];
        energySourceChart.data.datasets[1].data = [redePercent];
        energySourceChart.update();
      }

    // Update your chart initialization in index.html
      let co2Chart, energiaChart;     

      async function createCO2Chart() {
        
        const endTs = new Date(new Date().getFullYear(), new Date().getMonth() + 1 , 0, 23, 59, 59, 999).getTime();
        const startTs = new Date(new Date().getFullYear(), new Date().getMonth() - 11, 1).getTime();

        try {
          const [avoidedData, emittedData] = await Promise.all([
            getHistory('co2evitado', startTs, endTs),
            getHistory('co2emitido', startTs, endTs)
          ]);

          const avoided = processMonthlyData(avoidedData, 'co2evitado');
          const emitted = processMonthlyData(emittedData, 'co2emitido');

          const ctx = document.getElementById('chart-co2').getContext('2d');
          
          if (co2Chart) {
            co2Chart.data.labels = avoided.labels;
            co2Chart.data.datasets[0].data = avoided.values;
            co2Chart.data.datasets[1].data = emitted.values;
            co2Chart.update();
          } else {
            co2Chart = new Chart(ctx, {
              type: 'bar',
              data: {
                labels: avoided.labels,
                datasets: [
                  {
                    label: 'CO₂ Evitado (ton)',
                    data: avoided.values, 
                    backgroundColor: '#98F381FF',
                    borderColor: '#5DCC41FF',
                    borderWidth: 1
                  },
                  {
                    label: 'CO₂ Emitido (ton)',
                    data: emitted.values, 
                    backgroundColor: 'rgba(248,109,34,255)',
                    borderColor: 'rgba(248,109,34,255)',
                    borderWidth: 1
                  }
                ]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: { position: 'bottom',
                    labels: {
                      font: {
                        size: 16
                      },
                      usePointStyle: true,
                      pointStyle: 'rectRounded'
                    }
                  },
                  tooltip: {
                    mode: 'index',
                    intersect: false
                  }
                },
                scales: {
                  x: { 
                    stacked: true,
                    grid: { display: false }  
                  },
                  y: {
                    beginAtZero: true,
                    title: { display: true, text: 'Toneladas' },
                    grid: { display: false }  
                  }

                }
              }
            });
          }
        } catch (error) {
          console.error('Error creating CO2 chart:', error);
        }
      }

      

      async function createEnergiaChart() {


        const endTs = new Date(new Date().getFullYear(), new Date().getMonth() + 1 , 0, 23, 59, 59, 999).getTime();
        const startTs = new Date(new Date().getFullYear(), new Date().getMonth() - 11, 1).getTime();
       

        try {
          const [producedData, consumedData] = await Promise.all([
            getHistory('energiasolarconsumida', startTs, endTs),
            getHistory('energiaredeconsumida', startTs, endTs)
          ]);

          const produced = processMonthlyData(producedData, 'energiasolarconsumida');
          const consumed = processMonthlyData(consumedData, 'energiaredeconsumida');

          const ctx = document.getElementById('chart-energia').getContext('2d');
          
          if (energiaChart) {
            energiaChart.data.labels = produced.labels;
            energiaChart.data.datasets[0].data = produced.values;
            energiaChart.data.datasets[1].data = consumed.values;
            energiaChart.update();
          } else {
            energiaChart = new Chart(ctx, {
              type: 'bar',
              data: {
                labels: produced.labels,
                datasets: [
                  {
                    label: 'Energia Solar (kWh)',
                    data: produced.values,
                    backgroundColor: 'rgba(8,158,84,255)',
                    borderColor: 'rgba(8,158,84,255)',
                    borderWidth: 1
                  },
                  {
                    label: 'Energia Rede (kWh)',
                    data: consumed.values,
                    backgroundColor: 'rgba(235,158,10,255)',
                    borderColor: 'rgba(235,158,10,255)',
                    borderWidth: 1
                  }
                ]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: { position: 'bottom',
                    labels: {
                      font: {
                        size: 16
                      },
                      usePointStyle: true,
                      pointStyle: 'rectRounded'
                    }
                   },
                  tooltip: {
                    mode: 'index',
                    intersect: false
                  }
                },
                scales: {
                  x: { 
                    stacked: true,
                    grid: { display: false }  
                  },
                  y: {
                    stacked: true,
                    beginAtZero: true,
                    title: { display: true, text: 'kWh' },
                    grid: { display: false }  
                  }
                }
              }
            });
          }
        } catch (error) {
          console.error('Error creating Energy chart:', error);
        }
      }

      


// Initialize on DOM load
    document.addEventListener("DOMContentLoaded", async () => {
      const date = moment();
      document.getElementById("currentDate").textContent = date.format('D/MM/YYYY');
      
      await createCO2Chart();
      await createEnergiaChart();
    
    });

    let date = moment();

    let currentDate = date.format('D/MM/YYYY');
    console.log(currentDate);
    console.log(currentDate); 
    document.getElementById("currentDate").innerHTML = currentDate;



    
    
   
  </script>
  <script src="api.js"></script>
</body>
</html>